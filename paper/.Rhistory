#| echo: false
#| warning: false
#| message: false
#| fig-pos: H
#| tbl-cap: "Mean and Standard Deviation of each variable, for all Admission Category"
# Load the data
data <- read.csv("../data/analysis_data/cleaned_data.csv")
# Summary statistics
summary_statistics <- data %>%
filter(admission_category %in% selected_categories) %>%
filter(statistics %in% c("Median with income", "Total count", "Total with income")) %>%
group_by(admission_category) %>%
summarise
(
Total_Immi = sum(value[statistics == "Total count"]),
#| label: tbl-summary-statistics
#| echo: false
#| warning: false
#| message: false
#| fig-pos: H
#| tbl-cap: "Mean and Standard Deviation of each variable, for all Admission Category"
# Load the data
data <- read.csv("../data/analysis_data/cleaned_data.csv")
# Summary statistics
summary_statistics <- data %>%
filter(admission_category %in% selected_categories) %>%
filter(statistics %in% c("Median with income", "Total count", "Total with income")) %>%
group_by(admission_category) %>%
summarise
(
Total_Immi = sum(value[statistics == "Total count"]),
#| label: tbl-summary-statistics
#| echo: false
#| warning: false
#| message: false
#| fig-pos: H
#| tbl-cap: "Mean and Standard Deviation of each variable, for all Admission Category"
# Load the data
data <- read.csv("../data/analysis_data/cleaned_data.csv")
# Summary statistics
summary_statistics <- data %>%
filter(admission_category %in% selected_categories) %>%
filter(statistics %in% c("Median with income", "Total count", "Total with income")) %>%
group_by(admission_category) %>%
summarise (
Total_Immi = sum(value[statistics == "Total count"]),
Total_Immi_with_income = sum(value[statistics == "Total with income"]),
Median_Income = mean(value[statistics == "Median with income"])
)
View(summary_statistics)
#| label: tbl-summary-statistics
#| echo: false
#| warning: false
#| message: false
#| fig-pos: H
#| tbl-cap: "Mean and Standard Deviation of each variable, for all Admission Category"
# Load the data
data <- read.csv("../data/analysis_data/cleaned_data.csv")
# Summary statistics
summary_statistics <- data %>%
filter(admission_category %in% selected_categories) %>%
filter(statistics %in% c("Median with income", "Total count", "Total with income")) %>%
group_by(admission_category) %>%
summarise (
Total_Immi = sum(value[statistics == "Total count"]),
Total_Immi_with_income = sum(value[statistics == "Total with income"]),
Median_Income = mean(value[statistics == "Median with income"])
)
summary <- summary_statistics %>%
summarise(
Mean_Total_Immi = mean(Total_Immi),
Median_Total_Immi = median(Total_Immi),
SD_Total_Immi = sd(Total_Immi),
Max_Total_Immi = max(Total_Immi),
Min_Total_Immi = min(Total_Immi),
Mean_Total_Immi_with_income = mean(Total_Immi_with_income),
Median_Total_Immi_with_income = median(Total_Immi_with_income),
SD_Total_Immi_with_income = sd(Total_Immi_with_income),
Max_Total_Immi_with_income = max(Total_Immi_with_income),
Min_Total_Immi_with_income = min(Total_Immi_with_income),
Mean_Median_Income = mean(Median_Income),
Median_Median_Income = median(Median_Income),
SD_Median_Income = sd(Median_Income),
Max_Median_Income = max(Median_Income),
Min_Median_Income = min(Median_Income)
)
# Print the summary statistics
kable(summary, booktabs = TRUE, caption = "Summary Statistics of the data by Admission Category")
View(summary)
#| label: tbl-summary-statistics
#| echo: false
#| warning: false
#| message: false
#| fig-pos: H
#| tbl-cap: "Mean and Standard Deviation of each variable, for all Admission Category"
# Load the data
data <- read.csv("../data/analysis_data/cleaned_data.csv")
# Summary statistics
summary_statistics <- data %>%
filter(admission_category %in% selected_categories) %>%
filter(statistics %in% c("Median with income", "Total count", "Total with income")) %>%
group_by(admission_category) %>%
summarise (
Total_Immi = sum(value[statistics == "Total count"]),
Total_Immi_with_income = sum(value[statistics == "Total with income"]),
Median_Income = mean(value[statistics == "Median with income"])
)
summary <- summary_statistics %>%
summarise(
Mean_Total_Immi = mean(Total_Immi),
Median_Total_Immi = median(Total_Immi),
SD_Total_Immi = sd(Total_Immi),
Max_Total_Immi = max(Total_Immi),
Min_Total_Immi = min(Total_Immi),
Mean_Total_Immi_with_income = mean(Total_Immi_with_income),
Median_Total_Immi_with_income = median(Total_Immi_with_income),
SD_Total_Immi_with_income = sd(Total_Immi_with_income),
Max_Total_Immi_with_income = max(Total_Immi_with_income),
Min_Total_Immi_with_income = min(Total_Immi_with_income),
Mean_Median_Income = mean(Median_Income),
Median_Median_Income = median(Median_Income),
SD_Median_Income = sd(Median_Income),
Max_Median_Income = max(Median_Income),
Min_Median_Income = min(Median_Income)
)
# Create the summary table
summary_table <- summary %>%
pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value") %>%
mutate(Variable = case_when(
Variable %in% c("Mean_Total_Immi", "Median_Total_Immi", "SD_Total_Immi", "Max_Total_Immi", "Min_Total_Immi") ~ "Total Immigrant",
Variable %in% c("Mean_Total_Immi_with_income", "Median_Total_Immi_with_income", "SD_Total_Immi_with_income", "Max_Total_Immi_with_income", "Min_Total_Immi_with_income") ~ "Total with Income",
Variable %in% c("Mean_Median_Income", "Median_Median_Income", "SD_Median_Income", "Max_Median_Income", "Min_Median_Income") ~ "Median Income"
)) %>%
arrange(match(Variable, c("Total Immigrant", "Total with Income", "Median Income")))
# Print the table
kable(summary_table, format = "markdown", col.names = c("Variable", "Mean", "Median", "Standard Deviation", "Maximum", "Minimum"))
#| label: tbl-summary-statistics
#| echo: false
#| warning: false
#| message: false
#| fig-pos: H
#| tbl-cap: "Mean and Standard Deviation of each variable, for all Admission Category"
# Load the data
data <- read.csv("../data/analysis_data/cleaned_data.csv")
# Summary statistics
summary_statistics <- data %>%
filter(admission_category %in% selected_categories) %>%
filter(statistics %in% c("Median with income", "Total count", "Total with income")) %>%
group_by(admission_category) %>%
summarise (
Total_Immi = sum(value[statistics == "Total count"]),
Total_Immi_with_income = sum(value[statistics == "Total with income"]),
Median_Income = mean(value[statistics == "Median with income"])
)
# Aggregate summary statistics
summary <- summary_statistics %>%
summarise(
Mean_Total_Immi = mean(Total_Immi),
Median_Total_Immi = median(Total_Immi),
SD_Total_Immi = sd(Total_Immi),
Max_Total_Immi = max(Total_Immi),
Min_Total_Immi = min(Total_Immi),
Mean_Total_Immi_with_income = mean(Total_Immi_with_income),
Median_Total_Immi_with_income = median(Total_Immi_with_income),
SD_Total_Immi_with_income = sd(Total_Immi_with_income),
Max_Total_Immi_with_income = max(Total_Immi_with_income),
Min_Total_Immi_with_income = min(Total_Immi_with_income),
Mean_Median_Income = mean(Median_Income),
Median_Median_Income = median(Median_Income),
SD_Median_Income = sd(Median_Income),
Max_Median_Income = max(Median_Income),
Min_Median_Income = min(Median_Income)
)
# Create the summary table
summary_table <- summary %>%
pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value") %>%
mutate(Variable = case_when(
Variable %in% c("Mean_Total_Immi", "Median_Total_Immi", "SD_Total_Immi", "Max_Total_Immi", "Min_Total_Immi") ~ "Total Immigrant",
Variable %in% c("Mean_Total_Immi_with_income", "Median_Total_Immi_with_income", "SD_Total_Immi_with_income", "Max_Total_Immi_with_income", "Min_Total_Immi_with_income") ~ "Total with Income",
Variable %in% c("Mean_Median_Income", "Median_Median_Income", "SD_Median_Income", "Max_Median_Income", "Min_Median_Income") ~ "Median Income"
)) %>%
arrange(match(Variable, c("Total Immigrant", "Total with Income", "Median Income")))
# Print the table
kable(summary_table, format = "markdown", col.names = c("Variable", "Mean", "Median", "Standard Deviation", "Maximum", "Minimum"))
View(summary_table)
View(summary)
View(summary_statistics)
#| label: tbl-summary-statistics
#| echo: false
#| warning: false
#| message: false
#| fig-pos: H
#| tbl-cap: "Mean and Standard Deviation of each variable, for all Admission Category"
# Load the data
data <- read.csv("../data/analysis_data/cleaned_data.csv")
# Summary statistics
summary_statistics <- data %>%
filter(admission_category %in% selected_categories) %>%
filter(statistics %in% c("Median with income", "Total count", "Total with income")) %>%
group_by(admission_category) %>%
summarise (
Total_Immi = sum(value[statistics == "Total count"]),
Total_Immi_with_income = sum(value[statistics == "Total with income"]),
Median_Income = mean(value[statistics == "Median with income"])
)
# Aggregate summary statistics
summary_statistics_summary <- summary_statistics %>%
summarise(
Mean_Total_Immi = mean(Total_Immi),
SD_Total_Immi = sd(Total_Immi),
Mean_Total_Immi_with_income = mean(Total_Immi_with_income),
SD_Total_Immi_with_income = sd(Total_Immi_with_income),
Mean_Median_Income = mean(Median_Income),
SD_Median_Income = sd(Median_Income)
)
# Print the table
kable(summary_table, format = "markdown", col.names = c("Variable", "Mean", "Median", "Standard Deviation", "Maximum", "Minimum"))
View(summary_statistics_summary)
#| label: tbl-summary-statistics
#| echo: false
#| warning: false
#| message: false
#| fig-pos: H
#| tbl-cap: "Mean and Standard Deviation of each variable, for all Admission Category"
# Load the data
data <- read.csv("../data/analysis_data/cleaned_data.csv")
# Summary statistics
summary_statistics <- data %>%
filter(admission_category %in% selected_categories) %>%
filter(statistics %in% c("Median with income", "Total count", "Total with income")) %>%
group_by(admission_category) %>%
summarise (
Total_Immi = sum(value[statistics == "Total count"]),
Total_Immi_with_income = sum(value[statistics == "Total with income"]),
Median_Income = mean(value[statistics == "Median with income"])
)
# Summary Statistics
total_immi_mean <- mean(summary_statistics$Total_Immi)
total_immi_sd <- sd(summary_statistics$Total_Immi)
total_immi_with_income_mean <- mean(summary_statistics$Total_Immi_with_income)
total_immi_with_income_sd <- sd(summary_statistics$Total_Immi_with_income)
median_income_mean <- mean(summary_statistics$Median_Income)
median_income_sd <- sd(summary_statistics$Median_Income)
# Create a table
summary_table <- tibble(
Variable = c("Total Immigrants", "Total Immigrants with Income", "Median Income (in $CAD)"),
Mean = c(total_immi_mean, total_immi_with_income_mean, median_income_mean),
SD = c(total_immi_sd, total_immi_with_income_sd, median_income_sd)
)
# Print the table
kable(summary_table, booktabs = TRUE, col.names = c("Variable", "Mean", "Standard Deviation"))
#| warning: false
#| message: false
#| include: false
# Read the data
model_data <- read.csv("../data/analysis_data/cleaned_data.csv")
model_data <- cleaned_data %>%
filter(statistics %in% c("Median with income", "Total count", "Total with income")) %>%
filter(admission_category %in% selected_categories) %>%
filter(admission_category != "Economic Immigrant, principal applicant") %>%
mutate(admission_category = if_else(admission_category == "Total, immigrant admission category", "Principal applicant", admission_category)) %>%
group_by(admission_category, year) %>%
summarise(
Total_count = value[statistics == "Total count"],
Total_with_income = value[statistics == "Total with income"],
Median_income = value[statistics == "Median with income"]
)
# Fit the model
admission_category_neg_binomial <-
stan_glm(
Total_count ~ admission_category + Median_income,
data = model_data,
family = neg_binomial_2(link = "log"),
prior = normal(location = 0, scale = 2.5, autoscale = TRUE),
prior_intercept = normal(location = 0, scale = 2.5, autoscale = TRUE),
seed = 853
)
prior_summary(admission_category_neg_binomial)
# Print the summary of the model
# summary(admission_category_neg_binomial)
# ### Save the model ###
saveRDS(admission_category_neg_binomial, "../models/admission_category_neg_binomial.rds")
#| echo: false
#| eval: true
#| label: tbl-SEmodelresults
#| tbl-cap: "Model Summary for Negative Binomial Regression on Immigrants Admission Category and Income"
#| warning: false
# Read the data
neg_binomial_data <- readRDS(file = here::here("models/admission_category_neg_binomial.rds"))
#| echo: false
#| eval: true
#| label: tbl-SEmodelresults
#| tbl-cap: "Model Summary for Negative Binomial Regression on Immigrants Admission Category and Income"
#| warning: false
# Read the data
neg_binomial_data <- readRDS("../models/neg_binomial.rds")
#| echo: false
#| eval: true
#| label: tbl-SEmodelresults
#| tbl-cap: "Model Summary for Negative Binomial Regression on Immigrants Admission Category and Income"
#| warning: false
# Read the data
binomial_model <-
readRDS(file = here::here("models/admission_category_neg_binomial.rds"))
#| echo: false
# All the required packages
## Installing Packages only needs to be done once
# install.packages("tidyverse")
# install.packages("tinytex")
# install.packages("kableExtra")
# install.packages("patchwork")
# install.packages("janitor")
# install.packages("gridExtra")
# install.packages("devtools")
# devtools::install_github("warint/statcanR")
# install.packages("cansim")
# install.packages("modelsummary")
# install.packages("rstanarm")
# install.packages("broom")
# install.packages('styler')
# install.packages("knitr")
install.packages("here")
#| include: false
#| warning: false
#| message: false
library(tidyverse)
library(tinytex)
library(knitr)
library(dplyr)
library(ggplot2)
library(janitor)
library(patchwork)
library(kableExtra)
library(gridExtra)
library(devtools)
library(statcanR)
library(cansim)
library(modelsummary)
library(rstanarm)
library(arrow)
library(broom)
library(styler)
library(here)
#| label: tbl-summary-statistics
#| echo: false
#| warning: false
#| message: false
#| fig-pos: H
#| tbl-cap: "Mean and Standard Deviation of each variable, for all Admission Category"
# Load the data
data <- read.csv("../data/analysis_data/cleaned_data.csv")
# Summary statistics
summary_statistics <- data %>%
filter(admission_category %in% selected_categories) %>%
filter(statistics %in% c("Median with income", "Total count", "Total with income")) %>%
group_by(admission_category) %>%
summarise (
Total_Immi = sum(value[statistics == "Total count"]),
Total_Immi_with_income = sum(value[statistics == "Total with income"]),
Median_Income = mean(value[statistics == "Median with income"])
)
# Summary Statistics
total_immi_mean <- mean(summary_statistics$Total_Immi)
total_immi_sd <- sd(summary_statistics$Total_Immi)
total_immi_with_income_mean <- mean(summary_statistics$Total_Immi_with_income)
total_immi_with_income_sd <- sd(summary_statistics$Total_Immi_with_income)
median_income_mean <- mean(summary_statistics$Median_Income)
median_income_sd <- sd(summary_statistics$Median_Income)
# Create a table
summary_table <- tibble(
Variable = c("Total Immigrants", "Total Immigrants with Income", "Median Income (in $CAD)"),
Mean = c(total_immi_mean, total_immi_with_income_mean, median_income_mean),
SD = c(total_immi_sd, total_immi_with_income_sd, median_income_sd)
)
# Print the table
kable(summary_table, booktabs = TRUE, col.names = c("Variable", "Mean", "SD"))
#| echo: false
#| eval: true
#| label: tbl-SEmodelresults
#| tbl-cap: "Model Summary for Negative Binomial Regression on Immigrants Admission Category and Income"
#| warning: false
# Read the data
binomial_model <-
readRDS(file = here::here("models/admission_category_neg_binomial.rds"))
#| echo: false
#| eval: true
#| label: tbl-SEmodelresults
#| tbl-cap: "Model Summary for Negative Binomial Regression on Immigrants Admission Category and Income"
#| warning: false
#|
# Read the data
binomial_model <-
readRDS(file = here::here("models/admission_category_neg_binomial.rds"))
#| echo: false
#| eval: true
#| label: tbl-SEmodelresults
#| tbl-cap: "Model Summary for Negative Binomial Regression on Immigrants Admission Category and Income"
#| warning: false
# Read the data
binomial_model <-
readRDS(file = here::here("../models/admission_category_neg_binomial.rds"))
#| echo: false
#| eval: true
#| label: tbl-SEmodelresults
#| tbl-cap: "Model Summary for Negative Binomial Regression on Immigrants Admission Category and Income"
#| warning: false
# Read the data
binomial_model <-
readRDS(file = here::here("models", "neg_binomial.rds"))
#| message: false
#| echo: false
#| label: tbl-table1
#| tbl-cap: "Total Immigrants Admission by Income, Canada, 2001-2016"
#| tbl-pos: "h"
## Load the cleaned data
cleaned_data <- read.csv("../data/analysis_data/cleaned_data.csv")
table1 <- cleaned_data %>%
filter(admission_category == "Total, immigrant admission category") |>
select(year, statistics, value) %>%
pivot_wider(names_from = statistics, values_from = value) %>%
rename(
"Year" = year,
"Total Admission" = "Total count",
"Total Admission with Income" = "Total with income",
"Median Income (in $CAD)" = "Median with income",
"Mean Income (in $CAD)" = "Mean with income"
)
## Use kable to print the table
kable(table1, booktabs = TRUE)
#| message: false
#| echo: false
#| label: tbl-table1
#| tbl-cap: "Total Immigrants Admission by Income, Canada, 2001-2016"
#| tbl-pos: "h"
## Load the cleaned data
cleaned_data <- read.csv("../data/analysis_data/cleaned_data.csv")
table1 <- cleaned_data %>%
filter(admission_category == "Total, immigrant admission category") |>
select(year, statistics, value) %>%
pivot_wider(names_from = statistics, values_from = value) %>%
rename(
"Year" = year,
"Total Admission" = "Total count",
"Total Admission with Income" = "Total with income",
"Median Income (in $CAD)" = "Median with income",
"Mean Income (in $CAD)" = "Mean with income"
)
## Use kable to print the table
kable(table1, booktabs = TRUE)
head(table1, 10) |>
arrange (Year) |>
kable(
booktabs = TRUE,
col.names = c("Year", "Total Admission", "Total Admission with Income", "Median Income (in $CAD)", "Mean Income (in $CAD)"),
align = c("c", "l", "c", "c", "c", "c", "c", "c", "c")
)
#| message: false
#| echo: false
#| label: tbl-table1
#| tbl-cap: "Total Immigrants Admission by Income, Canada, 2001-2016"
#| tbl-pos: "h"
## Load the cleaned data
cleaned_data <- read.csv("../data/analysis_data/cleaned_data.csv")
table1 <- cleaned_data %>%
filter(admission_category == "Total, immigrant admission category") |>
select(year, statistics, value) %>%
pivot_wider(names_from = statistics, values_from = value) %>%
rename(
"Year" = year,
"Total Admission" = "Total count",
"Total Admission with Income" = "Total with income",
"Median Income (in $CAD)" = "Median with income",
"Mean Income (in $CAD)" = "Mean with income"
)
head(table1, 10) |>
arrange (Year) |>
kable(
booktabs = TRUE,
col.names = c("Year", "Total Admission", "Total Admission with Income", "Median Income (in $CAD)", "Mean Income (in $CAD)"),
align = c("c", "l", "c", "c", "c", "c", "c", "c", "c")
)
#| echo: false
# All the required packages
## Installing Packages only needs to be done once
# install.packages("tidyverse")
# install.packages("tinytex")
# install.packages("kableExtra")
# install.packages("patchwork")
# install.packages("janitor")
# install.packages("gridExtra")
# install.packages("devtools")
# devtools::install_github("warint/statcanR")
# install.packages("cansim")
# install.packages("modelsummary")
# install.packages("rstanarm")
# install.packages("broom")
# install.packages('styler')
# install.packages("knitr")
# install.packages("here")
# Uncomment the following lines to install the required packages only once:
install.packages("tinytex")
install.packages("tidyverse")
install.packages("knitr")
install.packages("kableExtra")
install.packages("here")
install.packages("ggbeeswarm")
install.packages("rstanarm")
install.packages("arrow")
install.packages("tidybayes")
install.packages("modelsummary")
install.packages("broom.mixed")
install.packages("tidyverse")
